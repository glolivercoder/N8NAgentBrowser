<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>N8N Workflow Assistant</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <img src="../assets/icons/icon48.png" alt="N8N Workflow Assistant">
        <h1>N8N Workflow Assistant</h1>
      </div>
      <div class="status">
        <span id="connection-status" class="status-indicator"></span>
      </div>
    </header>

    <div class="tabs">
      <button class="tab-btn active" data-tab="home">In√≠cio</button>
      <button class="tab-btn" data-tab="create">Criar</button>
      <button class="tab-btn" data-tab="analyze">Analisar</button>
      <button class="tab-btn" data-tab="settings">Configura√ß√µes</button>
    </div>

    <div class="tab-content">
      <!-- Tab: Home -->
      <div id="home" class="tab-pane active">
        <div class="welcome">
          <h2>Bem-vindo ao N8N Workflow Assistant</h2>
          <p>Crie e otimize workflows N8N com a ajuda de IA</p>
        </div>

        <div class="quick-actions">
          <button id="btn-new-workflow" class="action-btn">
            <span class="icon">‚ûï</span>
            <span>Novo Workflow</span>
          </button>
          <button id="btn-analyze-workflow" class="action-btn">
            <span class="icon">üîç</span>
            <span>Analisar Workflow</span>
          </button>
          <button id="btn-improve-workflow" class="action-btn">
            <span class="icon">‚ö°</span>
            <span>Otimizar Workflow</span>
          </button>
        </div>

        <div class="recent-workflows">
          <h3>Workflows Recentes</h3>
          <div id="recent-workflows-list" class="list">
            <p class="empty-state">Nenhum workflow recente</p>
          </div>
        </div>
      </div>

      <!-- Tab: Create -->
      <div id="create" class="tab-pane">
        <h2>Criar Novo Workflow</h2>
        
        <form id="create-workflow-form">
          <div class="form-group">
            <label for="workflow-name">Nome do Workflow:</label>
            <input type="text" id="workflow-name" placeholder="Meu Novo Workflow">
          </div>
          
          <div class="form-group">
            <label for="workflow-description">Descri√ß√£o (o que o workflow deve fazer):</label>
            <textarea id="workflow-description" rows="5" placeholder="Descreva em detalhes o que voc√™ deseja que o workflow fa√ßa..."></textarea>
          </div>
          
          <div class="form-group">
            <label>Tipo de Trigger:</label>
            <div class="radio-group">
              <label>
                <input type="radio" name="trigger-type" value="webhook" checked>
                Webhook
              </label>
              <label>
                <input type="radio" name="trigger-type" value="schedule">
                Agendamento
              </label>
              <label>
                <input type="radio" name="trigger-type" value="manual">
                Manual
              </label>
            </div>
          </div>
          
          <div class="form-group">
            <label>Op√ß√µes Avan√ßadas:</label>
            <div class="checkbox-group">
              <label>
                <input type="checkbox" id="include-error-handling">
                Incluir tratamento de erros
              </label>
              <label>
                <input type="checkbox" id="include-logging">
                Incluir logging
              </label>
            </div>
          </div>
          
          <div class="form-actions">
            <button type="submit" class="primary-btn">Gerar Workflow</button>
          </div>
        </form>
        
        <div id="generation-result" class="result-container hidden">
          <div class="result-header">
            <h3>Workflow Gerado</h3>
            <button id="copy-workflow" class="icon-btn">üìã</button>
          </div>
          <pre id="workflow-json"></pre>
          <div class="result-actions">
            <button id="download-workflow" class="secondary-btn">Baixar JSON</button>
            <button id="import-to-n8n" class="primary-btn">Importar para N8N</button>
          </div>
        </div>
      </div>

      <!-- Tab: Analyze -->
      <div id="analyze" class="tab-pane">
        <h2>Analisar Workflow</h2>
        
        <div class="form-group">
          <label for="workflow-source">Selecione a fonte do workflow:</label>
          <div class="radio-group">
            <label>
              <input type="radio" name="workflow-source" value="current" checked>
              Workflow atual no N8N
            </label>
            <label>
              <input type="radio" name="workflow-source" value="upload">
              Fazer upload de JSON
            </label>
            <label>
              <input type="radio" name="workflow-source" value="paste">
              Colar JSON
            </label>
          </div>
        </div>
        
        <div id="workflow-upload" class="form-group hidden">
          <label for="workflow-file">Selecione o arquivo JSON:</label>
          <input type="file" id="workflow-file" accept=".json">
        </div>
        
        <div id="workflow-paste" class="form-group hidden">
          <label for="workflow-json-input">Cole o JSON do workflow:</label>
          <textarea id="workflow-json-input" rows="5" placeholder="Cole o JSON do workflow aqui..."></textarea>
        </div>
        
        <div class="form-group">
          <label for="analysis-type">Tipo de an√°lise:</label>
          <select id="analysis-type">
            <option value="complete">An√°lise completa</option>
            <option value="performance">Performance</option>
            <option value="security">Seguran√ßa</option>
            <option value="best-practices">Melhores pr√°ticas</option>
          </select>
        </div>
        
        <div class="form-actions">
          <button id="analyze-btn" class="primary-btn">Analisar Workflow</button>
        </div>
        
        <div id="analysis-result" class="result-container hidden">
          <h3>Resultado da An√°lise</h3>
          <div id="analysis-content"></div>
        </div>
      </div>

      <!-- Tab: Settings -->
      <div id="settings" class="tab-pane">
        <h2>Configura√ß√µes</h2>
        
        <form id="settings-form">
          <div class="form-group">
            <label for="openrouter-api-key">OpenRouter API Key:</label>
            <div class="api-key-input">
              <input type="password" id="openrouter-api-key" placeholder="Insira sua API key da OpenRouter">
              <button type="button" id="toggle-api-key" class="icon-btn">üëÅÔ∏è</button>
            </div>
            <small>Obtenha sua API key em <a href="https://openrouter.ai/keys" target="_blank">openrouter.ai/keys</a></small>
          </div>
          
          <div class="form-group">
            <label for="default-model">Modelo padr√£o:</label>
            <select id="default-model">
              <option value="meta-llama/llama-3.1-8b-instruct:free">Llama 3.1 8B (Gratuito)</option>
              <option value="anthropic/claude-3-opus:beta">Claude 3 Opus</option>
              <option value="anthropic/claude-3-sonnet:beta">Claude 3 Sonnet</option>
              <option value="gpt-4o">GPT-4o</option>
              <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="theme">Tema:</label>
            <select id="theme">
              <option value="light">Claro</option>
              <option value="dark">Escuro</option>
              <option value="system">Sistema</option>
            </select>
          </div>
          
          <div class="form-group">
            <label>N8N Instances:</label>
            <div id="n8n-instances">
              <div class="instance-item">
                <input type="text" placeholder="URL da inst√¢ncia N8N (ex: http://localhost:5678)" class="instance-url">
                <button type="button" class="remove-instance icon-btn">‚ùå</button>
              </div>
            </div>
            <button type="button" id="add-instance" class="secondary-btn">Adicionar Inst√¢ncia</button>
          </div>
          
          <div class="form-actions">
            <button type="submit" class="primary-btn">Salvar Configura√ß√µes</button>
          </div>
        </form>
        
        <div class="api-usage">
          <h3>Uso da API</h3>
          <div id="api-usage-stats">
            <p class="empty-state">Configure sua API key para ver estat√≠sticas de uso</p>
          </div>
        </div>
        
        <div class="about">
          <h3>Sobre</h3>
          <p>N8N Workflow Assistant v1.0.0</p>
          <p>Desenvolvido para a comunidade N8N</p>
          <p><a href="https://github.com/seu-usuario/n8n-workflow-assistant" target="_blank">GitHub</a> | <a href="https://github.com/seu-usuario/n8n-workflow-assistant/issues" target="_blank">Reportar Bug</a></p>
        </div>
      </div>
    </div>
  </div>

  <script src="popup.js" type="module"></script>
</body>
</html>
